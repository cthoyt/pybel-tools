<!DOCTYPE html >
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href='https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css'/>
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/graph.css')}}">
    <link rel="stylesheet" href="{{ url_for('static', filename='js/inspire-tree-1.12/inspire-tree.css')}}">
    <script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.5.0/d3.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.16.0/jquery.validate.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.4.0/svg.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/graph_controller/graph_controller.js') }}"></script>

    <script type="text/javascript" src="{{ url_for('static', filename='js/inspire-tree-1.12/inspire-tree-bundled.js') }}"></script>
    <script type="text/javascript">

         window.filters = {{ filter_json|safe }};

         console.log(window.filters);
         window.id = {{ network_id }};

        $(document).ready(function () {

         var tree = new InspireTree({
                target: '#tree',
                selection:{
                    mode: 'checkbox',
                   multiple: true
                },
                data: window.filters
            });

            tree.on('model.loaded', function() {
                tree.expand();
            });


        $( "#filter_form" ).submit(function( event ) {
             $.getJSON("/network/"+window.id, function( data ) {
                  init_d3_force(data);
            });
         });

        });
    </script>

</head>
<body>
<div class="container"><!-- /.container-fluid -->
    <div class="col-lg-12 graph-controller"><!-- /.graph-controls -->
        <nav class="navbar navbar-default">
            <div class="container">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav">
                        <!-- Nodes - Edges - Funcionalities - Export - Legend -->
                        <li class="controls dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" role="button">Nodes<span
                                    class="caret"></span></a>
                            <ul class="dropdown-menu controls-lower-case">
                                <div>
                                    <div class="input-group">
                                        <span class="input-group-addon" id="sizing-addon"><i
                                                class="fa fa-connectdevelop fa-0.5x"></i></span>
                                        <input placeholder="Node finder (click to show)" id="node-search"
                                               class="wide form-control"
                                               aria-describedby="sizing-addon1" type="text"/>
                                    </div>
                                </div>
                                <div id="node-list">
                                </div>
                            </ul>
                        </li>
                        <li class="controls dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" role="button">Edges<span
                                    class="caret"></span></a>
                            <ul class="dropdown-menu controls-lower-case">
                                <div>
                                    <div class="input-group">
                                        <span class="input-group-addon" id="sizing-addon"><i
                                                class="fa fa-connectdevelop fa-0.5x"></i></span>
                                        <input placeholder="Edge finder (click to show)" id="edge-search"
                                               class="form-control"
                                               aria-describedby="sizing-addon1" type="text"/>
                                    </div>
                                </div>
                                <div id="edge-list">
                                </div>
                            </ul>
                        </li>
                        <li class="controls"><a data-toggle="modal" data-target="#info-graph">Functionalities</a>
                        <li class="dropdown">
                            <a class="dropdown-toggle controls" data-toggle="dropdown" role="button">Export Graph<span
                                    class="caret"></span></a>
                            <ul class="dropdown-menu controls">
                                <li class="align_left"><a id="save-svg-graph">Save image <i class="fa fa-file-image-o"
                                ></i></a></li>
                            </ul>
                        </li>

                        <li class="controls"><a data-toggle="modal" data-target="#legend">Legend</a>
                        </li>
                    </ul>
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav>
    </div><!-- /.graph-controls -->

    <div class="container align_row">
        <div class="col-md-12">
            <h2 class="title text-center"> Biological Network Explorer</h2>
            <!-- / Force -->
            <div id="graph-chart">
            </div>
            <!-- /.Force -->
        </div>
    </div>
</div><!-- /.container-fluid -->

<div id="info-graph" class="modal fade"><!-- /.info-graph Modal -->
    <div class="modal-dialog"><!-- /.Modal dialog -->
        <div class="modal-content"><!-- /.Modal content -->
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    ×
                </button>
                <h4 class="modal-title">Functionalities and info</h4>
            </div>

            <div class="modal-body text-left"><!-- /.Modal body -->

                <h4>Subgraph info</h4>
                <p class="color_red text-left">Number of nodes: <span class="color_black">{{ number_nodes }}</span></p>

                <p class="color_red text-left">Number of edges: <span class="color_black">{{ number_edges }}</span></p>

                <p class="color_red text-left">Average degree connectivity: <span
                        class="color_black">{{ number_edges }}</span>
                </p>

                <h5 class="text-left"><span class="color_red">Selection </span> Network</h5>
                <hr>
                <hr>
                <div class="text-center">
                    <button type="button" id="hide_node_names" class="btn btn-info">Hide BEL names
                    </button>
                    <button type="button" id="restore_node_names" class="btn btn-info">Restore BEL names
                    </button>
                    <button type="button" id="restore" class="btn btn-info">Restore ALL
                    </button>
                </div>
                <h4>Network Visualization Info</h4>
                <div class="table-wrapper">
                    <table class="table table-responsive">
                        <thead>
                        <tr>
                            <th><b>Function</b></th>
                            <th><b>Action</b></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>Expand/Delete node from the network</td>
                            <td>Right click on node</td>
                        </tr>
                        <tr>
                            <td>Freeze graph</td>
                            <td>Press Space</td>
                        </tr>
                        <tr>
                            <td>Pin a node down (fix it)</td>
                            <td>Drag the node to the desire position</td>
                        </tr>
                        <tr>
                            <td>Release node (unfix it)</td>
                            <td>Doubleclick on the node</td>
                        </tr>
                        <tr>
                            <td>Highlight node and its neighbourhood</td>
                            <td>Mouseover node</td>
                        </tr>
                        <tr>
                            <td>Zooming</td>
                            <td>Zooming buttons</td>
                        </tr>
                        <tr>
                            <td>Panning</td>
                            <td>Mouse click and drag</td>
                        </tr>
                        <tr>
                            <td>Undo changes</td>
                            <td>Double click in the graph</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <hr>
                <h4>Paths Visualization Info (Sankey Diagram)</h4>
                <div class="table-wrapper">
                    <table class="table table-responsive">
                        <thead>
                        <tr>
                            <th><b>Function</b></th>
                            <th><b>Action</b></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>See all connections of node via paths</td>
                            <td>Click on node</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div><!-- /.Modal body -->

            <div class="modal-footer">
                <button class="btn btn-default" data-dismiss="modal" type="button">
                    Close
                </button>
            </div>

        </div><!-- /.Modal content -->
    </div><!-- /.Modal dialog -->
</div><!-- /.info-graph Modal -->

<div aria-hidden="true" style="display: none;" id="legend" class="modal fade"><!-- /.Legend Modal -->
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Legend</h4>
            </div>
            <!-- .modal-header -->

            <div class="modal-body">
                <div id="accordion" class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <a class="collapsed" data-toggle="collapse" data-parent="#accordion"
                               data-target="#nodes-legend">
                                Nodes
                            </a>
                        </div>
                        <!-- .panel-heading -->

                        <div style="height: 0;" id="nodes-legend" class="panel-collapse collapse">
                            <div class="panel-body">
                                <div class="table-wrapper">
                                    <table class="table table-responsive">
                                        <thead>
                                        <tr>
                                            <th>Functions</th>
                                            <th>Symbol</th>
                                            <th>Description</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td class="col-md-2">p(A)</td>
                                            <td class="col-md-1">
                                                <div class="Protein"></div>
                                            </td>
                                            <td>Abundance of protein A</td>
                                        </tr>

                                        <tr>
                                            <td>a(A)</td>
                                            <td>
                                                <div class="Abundance"></div>
                                            </td>
                                            <td>Abundance of chemical A (or other non-gene, RNA, protein abundances)
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>r(A)</td>
                                            <td>
                                                <div class="RNA"></div>
                                            </td>
                                            <td>Abundance of RNA A</td>
                                        </tr>
                                        <tr>
                                            <td>m(A)</td>
                                            <td>
                                                <div class="miRNA"></div>
                                            </td>
                                            <td>Abundance of microRNA A</td>
                                        </tr>
                                        <tr>
                                            <td>g(A)</td>
                                            <td>
                                                <div class="Gene"></div>
                                            </td>
                                            <td>Abundance of gene A</td>
                                        </tr>
                                        <tr>
                                            <td>composite()</td>
                                            <td>
                                                <div class="Composite"></div>
                                            </td>
                                            <td>Multiple entity abundances synergize to produce an effect but are
                                                not
                                                known to be bound into a complex
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>complex()</td>
                                            <td>
                                                <div class="Complex"></div>
                                            </td>
                                            <td>Multiple entity abundances are bound into a complex</td>
                                        </tr>
                                        <tr>
                                            <td>path()</td>
                                            <td>
                                                <div class="Pathology"></div>
                                            </td>
                                            <td>Disease or pathology process</td>
                                        </tr>
                                        <tr>
                                            <td>bp()</td>
                                            <td>
                                                <div class="BiologicalProcess"></div>
                                            </td>
                                            <td>Biological process</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                    <!-- .table -->
                                </div>
                                <!-- .table-wrapper -->
                            </div>
                            <!-- .panel-body -->
                        </div>
                        <!-- #nodes-legend.panel-collapse -->
                    </div>
                    <!-- .panel.panel-default -->

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <a data-toggle="collapse" data-parent="#accordion" data-target="#edges-legend">
                                Edges
                            </a>
                        </div>
                        <!-- .panel-heading -->

                        <div style="height: auto;" id="edges-legend" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div class="table-wrapper">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>Relationship</th>
                                            <th>Line Style</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td class="bigger-rows">decreases</td>
                                            <td class="bigger-rows">
                                                <hr class="legend-continuous-line" width="30%"/>
                                                <span class="after-hr">&#124;</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="bigger-rows">directlyDecreases</td>
                                            <td class="bigger-rows">
                                                <hr class="legend-continuous-line" width="30%"/>
                                                <span class="after-hr">&#124;</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="bigger-rows">increases</td>
                                            <td class="bigger-rows">
                                                <hr class="legend-continuous-line" width="30%"/>
                                                <span class="after-hr">&#9658;</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="bigger-rows">directlyIncreases</td>
                                            <td class="bigger-rows">
                                                <hr class="legend-continuous-line" width="30%"/>
                                                <span class="after-hr">&#9658;</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>negativeCorrelation</td>
                                            <td>
                                                <hr class="legend-continuous-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>positiveCorrelation</td>
                                            <td>
                                                <hr class="legend-continuous-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>causesNoChange</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>association</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>orthologous</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>transcribedTo</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>translatedTo</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>biomarkerFor</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>hasMember</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>hasComponent</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>isA</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>prognosticBiomarkerFor</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>rateLimitingStepOf</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>subProcessOf</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>actsIn</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>hasProduct</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>hasVariant</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>hasModification</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>reactantIn</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>translocates</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>includes</td>
                                            <td>
                                                <hr class="legend-dashed-line" width="30%"/>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                    <!-- .table -->
                                </div>
                                <!-- .table-wrapper -->
                            </div>
                            <!-- .panel-body -->
                        </div>
                        <!-- #edges-legend.panel-collapse.collapse -->
                    </div>
                    <!-- .panel.panel-default -->
                </div>
                <!-- #accordian.panel-group -->
            </div>
            <!-- .modal-body -->

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    Close
                </button>
            </div>
            <!-- .modal-footer -->
        </div>
        <!-- .modal-content -->
    </div>
    <!-- .modal-dialog -->
</div><!-- .Legend Modal -->

             <div id="tree">
   </div>


</body>
</html>